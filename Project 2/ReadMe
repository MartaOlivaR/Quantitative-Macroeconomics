Updated again with changes on problem D.
