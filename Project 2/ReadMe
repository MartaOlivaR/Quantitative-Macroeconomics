Updated with a more complete version.
